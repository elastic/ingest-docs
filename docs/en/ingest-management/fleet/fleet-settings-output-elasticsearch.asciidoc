:type: output-elasticsearch-fleet-settings

[[es-output-settings]]
= {es} output settings

Specify these settings to send data over a secure connection to {es}. In the {fleet} <<output-settings,Output settings>>, make sure that {es} output type is selected.

TIP: You can <<external-elasticsearch-monitoring,send {agent} monitoring data to a remote {es} cluster>> by setting **Remote Elasticsearch** as the output type. Sending integrations data to a remote {es} cluster is currently not supported.

[cols="2*<a"]
|===
|
[id="es-output-hosts-setting"]
**Hosts**

| The {es} URLs where {agent}s will send data. By default, {es} is exposed
on the following ports:

`9200`::
Default {es} port for self-managed clusters

`443`::
Default {es} port for {ecloud}

**Examples:**

* `https://192.0.2.0:9200`
* `https://1d7a52f5eb344de18ea04411fe09e564.fleet.eu-west-1.aws.qa.cld.elstc.co:443`
* `https://[2001:db8::1]:9200`

Refer to the <<fleet-server,{fleet-server}>> documentation for default ports and other configuration details.

// =============================================================================

|
[id="es-trusted-fingerprint-yaml-setting"]
**{es} CA trusted fingerprint**

| HEX encoded SHA-256 of a CA certificate. If this certificate is
present in the chain during the handshake, it will be added to the
`certificate_authorities` list and the handshake will continue
normally. To learn more about trusted fingerprints, refer to the
{ref}/configuring-stack-security.html[{es} security documentation].

// =============================================================================

|
[id="es-agent-proxy-output"]
**Proxy**

| Select a proxy URL for {agent} to connect to {es}.
To learn about proxy configuration, refer to <<fleet-agent-proxy-support>>.

// =============================================================================

|
[id="es-output-advanced-yaml-setting"]
**Advanced YAML configuration**

| YAML settings that will be added to the {es} output section of each policy
that uses this output. Make sure you specify valid YAML. The UI does not
currently provide validation.

See <<es-output-settings-yaml-config>> for descriptions of the available settings.

// =============================================================================

|
[id="es-agent-integrations-output"]
**Make this output the default for agent integrations**

| When this setting is on, {agent}s use this output to send data if no other
output is set in the <<agent-policy,agent policy>>.

// =============================================================================

|
[id="es-agent-monitoring-output"]
**Make this output the default for agent monitoring**

| When this setting is on, {agent}s use this output to send <<monitor-elastic-agent,agent monitoring data>> if no other output is set in the <<agent-policy,agent policy>>.

Sending monitoring data to a remote {es} cluster is currently not supported.

// =============================================================================

|
[id="es-agent-performance-tuning"]
**Performance tuning**

| Choose one of the menu options to tune your {agent} performace when sending data to an {es} output. You can optimize for throughput, scale, latency, or select choose a balanced set of performance specifications. Refer to [Performance tuning settings] for details about the setting values and the potential impact on performance.

You can also use the <<es-output-settings-yaml-config,Advanced YAML configuration>> field to set custom values. Note that if you adjust performance settings through the advanced YAML configuration, the **Performance tuning** option automatically changes to `Custom`.
|===

[[es-output-settings-yaml-config]]
== Advanced YAML configuration

[cols="2*<a"]
|===
| Setting | Description

include::../elastic-agent/configuration/outputs/output-elasticsearch.asciidoc[tag=backoff.init-setting]

// =============================================================================

include::../elastic-agent/configuration/outputs/output-elasticsearch.asciidoc[tag=backoff.max-setting]

// =============================================================================

include::../elastic-agent/configuration/outputs/output-elasticsearch.asciidoc[tag=bulk_max_size-setting]

// =============================================================================

include::../elastic-agent/configuration/outputs/output-shared-settings.asciidoc[tag=compression_level-setting]

// =============================================================================

include::../elastic-agent/configuration/outputs/output-elasticsearch.asciidoc[tag=max_retries-setting]

// =============================================================================

include::../elastic-agent/configuration/outputs/output-elasticsearch.asciidoc[tag=timeout-setting]

// =============================================================================

include::../elastic-agent/configuration/outputs/output-shared-settings.asciidoc[tag=worker-setting]

|===


[[es-output-settings-performance-tuning-settings]]
== Performance tuning settings

.Performance tuning preset values
[cols="1,1,1,1,1"]
|===
|Configuration |Balanced|Optimized for Throughput |Optimized for Scale |Optimized for Latency

|`bulk_max_size`
|1600
|1600
|1600
|50

|`worker`
|1
|4
|1
|1

|`queue.mem.events`
|3200
|12800
|3200
|4100

|`flush.min_events`
|1600
|1600
|1600
|2050

|`flush.timeout`
|10
|5
|20
|1

|`compression`
|1
|1
|1
|1

|`idle_timeout`
|3
|15
|1
|60
|===

For descriptions of each setting, refer to <<es-output-settings-yaml-config,Advanced YAML configuration>>. For the  `queue.mem.events`, `flush.min_events` and `flush.timeout` settings, refer to the {filebeat-ref}/configuring-internal-queue.html[internal queue configuration settings] in the {filebeat} documentation.

.Potential performance effect
[cols="1,1,1,1,1"]
|===
|Configuration |Balanced|Optimized for Throughput |Optimized for Scale |Optimized for Latency

|Stateful throughput
|3x
|5x
|3x
|1x

|Serverless throughput
|5-10x
|10-20x
|5-10x
|1x

|Serverless throughput (relative to stateful)
|0.2-0.3x
|0.3-0.5x
|0.2-0.3x
|0.1x

|Connections
|0.3x
|4x
|0.04x
|1x

|Network traffic
|0.1x
|0.1x
|0.05x
|0.1x

|High-throughput queue latency
|1x
|1x
|1x
|1x

|Low-throughput queue latency
|10x
|5x
|20x
|1x
|===

:type!: